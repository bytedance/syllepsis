# 卡片插件

## 什么是卡片插件

若层体验 Notion 类产品（比如：[飞书文档](https://docs.feishu.cn)），可能会对文档中插入各种元素的方式感到兴趣。 这是一种不同的编辑体验：编辑器不再局限于图文，而支持插入各种应用（比如音视频、流程图、备忘录、甚至是小游戏等）。

在这些场景中，内部元素如同黑盒子，编辑器只是存放这些黑盒子的抽屉。换句话说，内部元素只在编辑器中占用一个索引的位置，而元素内容如何展示，编辑器并不关心。

对于这种前端轻量级应用集成的业务场景，我们将其抽象成了`卡片`（`Card`）。<small>

（八卦一下：可能开发者在其它地方也听过类似的说法，一些产品更愿意称之为`块`（`Block`），尽管`块`比`卡片`拥有更广的定义，但我们无意增加开发者的心智负担，也可以认为`卡片`是一种`块`）</small>

> 如果需要"关心"内部结构，使行为可预测，必须建立和结构一一对应的语法规则。声明这些语法的过程，复杂且缺少灵活性。<small>（但不代表不可实现，可参考之前的章节：[自定义插件](/zh-cn/chapters/custom-plugin.md)）</small>
>
> 根据经验，当插件过于复杂时，更推荐采用本章的方式。


## 代码摘要

和其它插件一样，卡片也有`Schema`和`Controller`。为了降低开发成本，`Controller`的交互逻辑由 `React Component`接管，开发者更多是在描述`Schema`，需要开发者自定义的内容有：

1. 声明什么样的数据会被识别为`卡片` （通过`parseDOM`, `textMatcher`实现）
2. 卡片将如何展示 （通过`ViewMap`描述）

而`ViewMap`也由两部分组成，分别为`template`和`mask`。可简单地认为：

- `template`：代表文本中持久化的数据
- `mask`：代表具体的展示方式（通常为`React`组件）

> Q: 为什么会有`template`和`mask`的区别。
> 
> A: 多数场合，为了节省存储空间，需要持久化的数据（`template`）应比展示方式（`mask`）简单。

<small>（八卦一下：`ViewMap`只是一个抽象命名，和张三、李四类似，没有更深层次的含义）</small>

## 示例

[card-plugin](https://codesandbox.io/embed/card-eh2um?hidenavigation=1 ':include :type=iframe width=100% height=500px')

## 更多

可通过[插件配置](/zh-cn/plugins/syl-plugin)了解更多插件属性说明